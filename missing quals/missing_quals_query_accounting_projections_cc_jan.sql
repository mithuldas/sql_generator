--320
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'AC32' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('AC32') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='AC32'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'AC32' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'E32' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('E32') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='E32'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'E32' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'K32' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('K32') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='K32'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'K32' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
--330

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'AC33' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('AC33') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='AC33'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'AC33' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'E33' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('E33') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='E33'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'E33' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'K33' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('K33') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='K33'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'K33' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
-- 777
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'AC77' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('AC77') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='AC77'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'AC77' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'E77' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('E77') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='E77'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'E77' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'K77' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('K77') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='K77'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'K77' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
--737
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'AC73' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('AC73') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='AC73'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'AC73' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'E73' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('E73') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='E73'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'E73' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'K73' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('K73') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='K73'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'K73' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
--SU9
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ACS9' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('ACS9') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='ACS9'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'ACS9' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ES9' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('ES9') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='ES9'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'ES9' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'KS9' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('KS9') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='KS9'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'KS9' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
--non fleet
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'DGS' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','777','737','SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('DGS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='DGS'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'DGS' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'FAL' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','777','737','SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('FAL') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='FAL'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'FAL' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'FCHK' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','777','737','SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('FCHK') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='FCHK'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'FCHK' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'GO' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','777','737','SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('GO') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='GO'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'GO' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'MC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','777','737','SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('MC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='MC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'MC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'MCH' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','777','737','SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('MCH') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='MCH'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'MCH' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'MKK' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','777','737','SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('MKK') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='MKK'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'MKK' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'PARU' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201502010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','777','737','SU9') 
			AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201502280000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('PA','BCA','EC','GM')
	AND ((TO_DATE('201502010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201502280000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('PARU') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201502280000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='PARU'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'PARU' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('28FEB15', 'DDMONYY'))) 
				ORDER BY STAFF_N;