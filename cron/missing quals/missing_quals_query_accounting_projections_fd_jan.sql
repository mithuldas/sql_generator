--320
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32EG' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('32EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='32EG'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '32EG' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32EW' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('32EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='32EW'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '32EW' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32G1' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('32G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='32G1'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '32G1' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32G2' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('32G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='32G2'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '32G2' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32LC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('32LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='32LC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '32LC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32PC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('32PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='32PC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '32PC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32VA' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('32VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='32VA'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '32VA' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32RS' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('32RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='32RS'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '32RS' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
--330
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33EG' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('33EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='33EG'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '33EG' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33EW' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('33EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='33EW'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '33EW' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33G1' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('33G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='33G1'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '33G1' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33G2' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('33G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='33G2'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '33G2' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33LC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('33LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='33LC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '33LC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33PC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('33PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='33PC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '33PC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33VA' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('33VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='33VA'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '33VA' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33RS' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('33RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='33RS'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '33RS' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
--777
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77EG' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('77EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='77EG'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '77EG' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77EW' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('77EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='77EW'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '77EW' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77G1' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('77G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='77G1'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '77G1' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77G2' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('77G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='77G2'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '77G2' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77LC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('77LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='77LC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '77LC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77PC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('77PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='77PC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '77PC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77VA' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('77VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='77VA'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '77VA' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77RS' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('77RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='77RS'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '77RS' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
--737
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37EG' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('37EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='37EG'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '37EG' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37EW' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('37EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='37EW'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '37EW' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37G1' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('37G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='37G1'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '37G1' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37G2' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('37G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='37G2'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '37G2' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37LC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('37LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='37LC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '37LC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37PC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('37PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='37PC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '37PC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37VA' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('37VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='37VA'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '37VA' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37RS' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('37RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='37RS'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '37RS' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
--SU9
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95EG' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('95EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='95EG'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '95EG' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95EW' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('95EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='95EW'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '95EW' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95G1' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('95G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='95G1'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '95G1' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95G2' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('95G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='95G2'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '95G2' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95LC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('95LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='95LC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '95LC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95PC' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('95PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='95PC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '95PC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95VA' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('95VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='95VA'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '95VA' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95RS' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('95RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='95RS'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = '95RS' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
--non fleet specific

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ALG1 (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('ALG1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='ALG1'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'ALG1' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ALG2 (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('ALG2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='ALG2'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'ALG2' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ENG4 (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('ENG4') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='ENG4'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'ENG4' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'INTF (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('INTF') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='INTF'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'INTF' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'MC (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('MC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='MC'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'MC' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'MCH (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('MCH') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='MCH'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'MCH' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'PARU (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('PARU') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='PARU'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'PARU' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'PRNV (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('PRNV') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='PRNV'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'PRNV' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'RVSM (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('RVSM') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='RVSM'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'RVSM' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'WXAW (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO', 'CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('WXAW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='WXAW'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'WXAW' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'CPL (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('FO')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('CPL') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='CPL'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'CPL' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;
				
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ATPL (all fleets)' as Missing_qual
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A 
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE('201501010000', 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
			AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
				OR (TO_DATE('201501310000', 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND (C.BASE IN ('SVO') AND C.PRIM_BASE = 'Y')
	AND B.RANK_CD IN ('CPT')
	AND ((TO_DATE('201501010000', 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE('201501310000', 'YYYYMMDDHH24MI') > P.EFF_DT)
	--qual
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_QUALIFICATIONS_V
		WHERE (QUAL_CD IN ('ATPL') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) BETWEEN TO_DATE('201411010000', 'YYYYMMDDHH24MI')
				AND TO_DATE('201501310000', 'YYYYMMDDHH24MI')) 
				or a.staff_num not in (select staff_num from crew_qualifications_V where qual_cd='ATPL'))
				AND staff_num NOT IN 
             (SELECT staff_num FROM crew_qualifications_t WHERE qual_cd = 'ATPL' AND actuals_status in ('T', 'V')
                AND TRUNC (expiry_dts) > TO_DATE ('31JAN15', 'DDMONYY'))) ORDER BY STAFF_N;				
				