--320

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32EG' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32EG')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '32EG' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32EW' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32EW')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '32EW' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32G1' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32G1')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '32G1' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32G2' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32G2')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '32G2' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32LC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32LC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '32LC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32PC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32PC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '32PC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32VA' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32VA')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '32VA' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '32RS' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('32RS')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '32RS' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;

--330

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33EG' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33EG')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '33EG' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33EW' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33EW')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '33EW' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33G1' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33G1')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '33G1' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33G2' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33G2')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '33G2' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33LC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33LC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '33LC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33PC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33PC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '33PC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33VA' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33VA')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '33VA' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '33RS' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('330') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('33RS')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '33RS' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
--737

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37EG' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37EG')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '37EG' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37EW' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37EW')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '37EW' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37G1' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37G1')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '37G1' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37G2' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37G2')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '37G2' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37LC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37LC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '37LC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37PC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37PC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '37PC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37VA' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37VA')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '37VA' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '37RS' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('737') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('37RS')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '37RS' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
--777

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77EG' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77EG')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '77EG' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77EW' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77EW')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '77EW' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77G1' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77G1')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '77G1' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77G2' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77G2')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '77G2' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77LC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77LC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '77LC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77PC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77PC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '77PC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77VA' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77VA')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '77VA' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '77RS' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('777') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('77RS')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '77RS' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
--SU9

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95EG' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95EG') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95EG')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '95EG' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95EW' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95EW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95EW')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '95EW' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95G1' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95G1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95G1')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '95G1' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95G2' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95G2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95G2')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '95G2' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95LC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95LC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95LC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '95LC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95PC' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95PC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95PC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '95PC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95VA' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95VA') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95VA')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '95VA' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, '95RS' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95RS') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('95RS')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = '95RS' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
--non fleet specific qualifications

SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ALG1- all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('ALG1') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('ALG1')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'ALG1' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ALG2- all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('ALG2') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('ALG2')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'ALG2' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ENG4 - all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('ENG4') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('ENG4')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'ENG4' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'INTF- all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('INTF') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('INTF')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'INTF' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'MC- all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('MC') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('MC')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'MC' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'MCH- all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('MCH') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('MCH')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'MCH' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'PARU- all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('PARU') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('PARU')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'PARU' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'WXAW- all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO','CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('WXAW') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('WXAW')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'WXAW' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'CPL- all fleets' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('FO')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('CPL') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('CPL')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'CPL' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;
  
  SELECT  DISTINCT A.STAFF_NUM  AS STAFF_N, A.PREFERRED_NAME,	A.FIRST_NAME, A.SURNAME, B.RANK_CD,	C.BASE,	P.RSRC_GRP_CD, 'ATPL' AS "QUAL"
FROM CREW_RANK_V B,	CREW_BASE_V C, CREW_RSRC_GRP_V P, CREW_V A
WHERE A.STAFF_NUM = B.STAFF_NUM	AND A.STAFF_NUM = C.STAFF_NUM AND A.STAFF_NUM = P.STAFF_NUM
	AND (A.TERM_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.TERM_DT IS NULL)
	AND (A.RETR_DT >= TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI')	OR A.RETR_DT IS NULL)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < B.EXP_DT OR B.EXP_DT IS NULL)	AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > B.EFF_DT)
	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < C.EXP_DT OR C.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > C.EFF_DT)
	AND A.STAFF_NUM IN (
		SELECT STAFF_NUM FROM CREW_FLEET_V WHERE VALID_IND = 'Y' AND FLEET_CD IN ('320','330','737','777','SU9') 
		AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY')))
		OR (TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') BETWEEN EFF_DT AND NVL(EXP_DT, TO_DATE('31-DEC-2999', 'DD-MON-YYYY'))))
		GROUP BY STAFF_NUM)
	AND B.RANK_CD IN ('CPT')	AND ((TO_DATE(to_char(trunc(add_months(sysdate,2), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') < P.EXP_DT OR P.EXP_DT IS NULL) AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') > P.EFF_DT)
	--QUAL
	AND (EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('ATPL') AND (NVL(EXPIRY_DTS, TO_DATE('31-DEC-2073', 'DD-MON-YYYY')) 
			BETWEEN TO_DATE(to_char(trunc(add_months(sysdate,-1), 'MON'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI') AND TO_DATE(to_char(trunc(last_day(add_months(sysdate,2)),'DD'),'YYYYMMDDHH24MI'), 'YYYYMMDDHH24MI'))) OR  
		NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD IN ('ATPL')))
	AND NOT EXISTS (SELECT 1 FROM CREW_QUALIFICATIONS_V Q WHERE Q.STAFF_NUM=A.STAFF_NUM AND QUAL_CD = 'ATPL' AND ACTUALS_STATUS IN ('T', 'V')
                AND EXPIRY_DTS > to_char((last_day(add_months(sysdate,2))),'DDMONYY')) 
  ORDER BY STAFF_N;